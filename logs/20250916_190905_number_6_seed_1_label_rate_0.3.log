Random Seed: 1
Label Rate: 0.3
Using CosineAnnealingWarmupRestarts lr.
Using monotonic beta schedule, cycle:4, ratio:1
Using cuda:5 device
PyTorch Version:  2.2.2+cu121
last lr:  [0.00026500000000000004]
Epoch 1/300, 
train total: 3.160289, reconstruct: 0.864348, kld_x: 0.000000, label: 0.997727, kld_y: 0.000000, koopman: 30.048698 
val total: 4.005468, reconstruct: 1.583964, kld_x: 0.000000, label: 1.052837, kld_y: 0.000000, koopman: 31.583102
last lr:  [0.0019150000000000003]
Epoch 11/300, 
train total: 2.501922, reconstruct: 0.498290, kld_x: 0.130658, label: 0.989934, kld_y: 0.090592, koopman: 1.060740 
val total: 3.019338, reconstruct: 0.909595, kld_x: 0.118065, label: 1.032171, kld_y: 0.092498, koopman: 3.350231
last lr:  [0.0035650000000000005]
Epoch 21/300, 
train total: 2.323393, reconstruct: 0.339827, kld_x: 0.180444, label: 0.979106, kld_y: 0.152729, koopman: 0.715654 
val total: 2.717941, reconstruct: 0.702087, kld_x: 0.182622, label: 0.991919, kld_y: 0.156558, koopman: 1.359774
last lr:  [0.005215]
Epoch 31/300, 
train total: 2.183111, reconstruct: 0.240609, kld_x: 0.291664, label: 0.955284, kld_y: 0.239709, koopman: 0.252811 
val total: 2.495376, reconstruct: 0.439453, kld_x: 0.293133, label: 1.012059, kld_y: 0.253212, koopman: 0.223975
last lr:  [0.006865000000000001]
Epoch 41/300, 
train total: 2.538151, reconstruct: 0.460941, kld_x: 0.550634, label: 1.005870, kld_y: 0.339111, koopman: 1.006772 
val total: 3.073156, reconstruct: 0.910669, kld_x: 0.610729, label: 1.044815, kld_y: 0.344833, koopman: 1.143975
last lr:  [0.008515]
Epoch 51/300, 
train total: 2.009303, reconstruct: 0.263258, kld_x: 0.553701, label: 0.843213, kld_y: 0.520410, koopman: 0.372900 
val total: 2.485454, reconstruct: 0.677616, kld_x: 0.581394, label: 0.873640, kld_y: 0.489823, koopman: 0.192910
last lr:  [0.009999575921491335]
Epoch 61/300, 
train total: 1.778487, reconstruct: 0.235051, kld_x: 0.636964, label: 0.739023, kld_y: 0.772314, koopman: 0.092111 
val total: 2.139288, reconstruct: 0.661606, kld_x: 0.709343, label: 0.702332, kld_y: 0.680136, koopman: 0.140422
last lr:  [0.009948774364757369]
Epoch 71/300, 
train total: 1.912605, reconstruct: 0.160342, kld_x: 0.804517, label: 0.835272, kld_y: 1.046289, koopman: 0.022133 
val total: 2.004077, reconstruct: 0.554120, kld_x: 0.774502, label: 0.685680, kld_y: 0.985403, koopman: 0.016166
last lr:  [0.009814153420445554]
Epoch 81/300, 
train total: 0.923866, reconstruct: 0.124039, kld_x: 0.073189, label: 0.396061, kld_y: 0.100433, koopman: 0.028471 
val total: 1.192938, reconstruct: 0.521496, kld_x: 0.058883, label: 0.332641, kld_y: 0.086586, koopman: 0.018590
last lr:  [0.009598016490237048]
Epoch 91/300, 
train total: 2.183629, reconstruct: 0.257420, kld_x: 0.186217, label: 0.953555, kld_y: 0.277056, koopman: 0.019929 
val total: 2.666023, reconstruct: 0.554123, kld_x: 0.176590, label: 1.046679, kld_y: 0.256967, koopman: 0.062588
last lr:  [0.009304061736932191]
Epoch 101/300, 
train total: 0.890913, reconstruct: 0.093701, kld_x: 0.303567, label: 0.382917, kld_y: 0.580870, koopman: 0.044052 
val total: 1.460875, reconstruct: 0.460886, kld_x: 0.312251, label: 0.484043, kld_y: 0.478778, koopman: 0.019843
last lr:  [0.008937318807859687]
Epoch 111/300, 
train total: 0.712805, reconstruct: 0.076769, kld_x: 0.452744, label: 0.294894, kld_y: 0.757219, koopman: 0.021587 
val total: 1.096674, reconstruct: 0.445886, kld_x: 0.429875, label: 0.303440, kld_y: 0.674695, koopman: 0.024505
last lr:  [0.008504062776216317]
Epoch 121/300, 
train total: 0.561268, reconstruct: 0.060679, kld_x: 0.606160, label: 0.219392, kld_y: 1.008637, koopman: 0.018037 
val total: 0.980452, reconstruct: 0.399871, kld_x: 0.584441, label: 0.260559, kld_y: 0.920461, koopman: 0.009916
last lr:  [0.008011706772824763]
Epoch 131/300, 
train total: 0.544556, reconstruct: 0.045527, kld_x: 0.719274, label: 0.212834, kld_y: 1.295207, koopman: 0.013878 
val total: 1.060486, reconstruct: 0.384608, kld_x: 0.717056, label: 0.301430, kld_y: 1.197758, koopman: 0.011535
last lr:  [0.007468675145409928]
Epoch 141/300, 
train total: 0.590195, reconstruct: 0.047329, kld_x: 0.811107, label: 0.230017, kld_y: 1.572076, koopman: 0.014974 
val total: 0.930070, reconstruct: 0.391768, kld_x: 0.835302, label: 0.226624, kld_y: 1.437187, koopman: 0.008565
last lr:  [0.00688425931567369]
Epoch 151/300, 
train total: 0.317523, reconstruct: 0.034992, kld_x: 0.000000, label: 0.141203, kld_y: 0.000000, koopman: 0.012540 
val total: 0.788845, reconstruct: 0.354348, kld_x: 0.000000, label: 0.217210, kld_y: 0.000000, koopman: 0.007677
last lr:  [0.006268458800493517]
Epoch 161/300, 
train total: 0.329898, reconstruct: 0.031349, kld_x: 0.142234, label: 0.141976, kld_y: 0.261676, koopman: 0.011213 
val total: 0.819502, reconstruct: 0.345862, kld_x: 0.143438, label: 0.229496, kld_y: 0.232278, koopman: 0.007226
last lr:  [0.005631810117416297]
Epoch 171/300, 
train total: 0.312193, reconstruct: 0.029825, kld_x: 0.292260, label: 0.126247, kld_y: 0.543957, koopman: 0.010473 
val total: 0.820569, reconstruct: 0.343136, kld_x: 0.296387, label: 0.223619, kld_y: 0.484170, koopman: 0.007217
last lr:  [0.004985206501921845]
Epoch 181/300, 
train total: 0.289535, reconstruct: 0.026164, kld_x: 0.427953, label: 0.109819, kld_y: 0.834378, koopman: 0.010346 
val total: 0.828526, reconstruct: 0.344287, kld_x: 0.444130, label: 0.219508, kld_y: 0.745540, koopman: 0.006462
last lr:  [0.0043397115211436625]
Epoch 191/300, 
train total: 0.280981, reconstruct: 0.025207, kld_x: 0.551619, label: 0.099691, kld_y: 1.130265, koopman: 0.010011 
val total: 0.820970, reconstruct: 0.343361, kld_x: 0.578722, label: 0.209327, kld_y: 1.019736, koopman: 0.006362
last lr:  [0.0037063697731678827]
Epoch 201/300, 
train total: 0.278374, reconstruct: 0.024083, kld_x: 0.666716, label: 0.093046, kld_y: 1.426473, koopman: 0.010049 
val total: 0.837590, reconstruct: 0.337772, kld_x: 0.708484, label: 0.213811, kld_y: 1.284763, koopman: 0.006203
last lr:  [0.003096017910897878]
Epoch 211/300, 
train total: 0.285505, reconstruct: 0.023671, kld_x: 0.778625, label: 0.091077, kld_y: 1.718411, koopman: 0.009835 
val total: 0.853057, reconstruct: 0.337751, kld_x: 0.833898, label: 0.215147, kld_y: 1.560797, koopman: 0.006188
last lr:  [0.0025190992239185928]
Epoch 221/300, 
train total: 0.289676, reconstruct: 0.023238, kld_x: 0.886043, label: 0.087862, kld_y: 2.010734, koopman: 0.009984 
val total: 0.856014, reconstruct: 0.337231, kld_x: 0.951427, label: 0.210875, kld_y: 1.829713, koopman: 0.006079
last lr:  [0.001985484950916323]
Epoch 231/300, 
train total: 0.198608, reconstruct: 0.021851, kld_x: 0.065798, label: 0.084967, kld_y: 0.143109, koopman: 0.010051 
val total: 0.758875, reconstruct: 0.333055, kld_x: 0.070595, label: 0.209284, kld_y: 0.131136, koopman: 0.006185
last lr:  [0.0015043053800479617]
Epoch 241/300, 
train total: 0.206779, reconstruct: 0.020701, kld_x: 0.208378, label: 0.082355, kld_y: 0.430098, koopman: 0.010001 
val total: 0.768646, reconstruct: 0.330665, kld_x: 0.221057, label: 0.207710, kld_y: 0.396105, koopman: 0.006036
last lr:  [0.0010837936271792504]
Epoch 251/300, 
train total: 0.216986, reconstruct: 0.020587, kld_x: 0.348866, label: 0.080345, kld_y: 0.722467, koopman: 0.010076 
val total: 0.785951, reconstruct: 0.331782, kld_x: 0.371242, label: 0.208160, kld_y: 0.663480, koopman: 0.006218
last lr:  [0.0007311447649896541]
Epoch 261/300, 
train total: 0.228820, reconstruct: 0.020540, kld_x: 0.482007, label: 0.079482, kld_y: 1.015598, koopman: 0.010048 
val total: 0.799343, reconstruct: 0.329046, kld_x: 0.516206, label: 0.208841, kld_y: 0.932948, koopman: 0.006117
last lr:  [0.00045239271328397504]
Epoch 271/300, 
train total: 0.239961, reconstruct: 0.020655, kld_x: 0.611473, label: 0.078374, kld_y: 1.309621, koopman: 0.010093 
val total: 0.825955, reconstruct: 0.329176, kld_x: 0.658718, label: 0.214823, kld_y: 1.200766, koopman: 0.006205
last lr:  [0.00025230699695156627]
Epoch 281/300, 
train total: 0.252909, reconstruct: 0.020598, kld_x: 0.739536, label: 0.078328, kld_y: 1.601626, koopman: 0.010033 
val total: 0.823865, reconstruct: 0.329389, kld_x: 0.799192, label: 0.206511, kld_y: 1.474238, koopman: 0.006104
last lr:  [0.00013431113807311487]
Epoch 291/300, 
train total: 0.267443, reconstruct: 0.020885, kld_x: 0.866451, label: 0.078957, kld_y: 1.898259, koopman: 0.010042 
val total: 0.848910, reconstruct: 0.328099, kld_x: 0.937902, label: 0.212612, kld_y: 1.734585, koopman: 0.006141
Best loss: 0.203402, best label loss: 0.203402, @ epoch: 223
train_rmse = 0.01991
train_mae = 0.01342
train_r2 =  0.85657
test_rmse = 2.42835
test_mae = 1.818
r2 =  76.51145
Training Time:319.91441Seconds
Testing Time:0.01943Seconds
